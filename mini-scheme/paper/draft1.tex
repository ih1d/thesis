\documentclass[acmsmall,screen]{acmart}

% Packages
\usepackage{booktabs}
\usepackage{subcaption}
\usepackage{listings}
\usepackage{xcolor}

% Haskell listing style
\lstdefinestyle{haskell}{
  language=Haskell,
  basicstyle=\ttfamily\small,
  keywordstyle=\color{blue},
  commentstyle=\color{gray},
  stringstyle=\color{red},
  showstringspaces=false
}

\title{A Tale of Two Monads: A Comparative Survey between Freer Monads and MTL}

\author{Isaac H. Lopez Diaz}
\affiliation{Department of Computer Science,
  \institution{University of Puerto Rico Rio Piedras}
  \country{Puerto Rico}
}
\email{isaac.lopez@upr.edu}

\begin{abstract}
% TODO: Write abstract
\end{abstract}

\keywords{effect systems, monads, algebraic effects, Haskell, interpreters}

\begin{document}

\maketitle

% ============================================================================
\section{Introduction}
\label{sec:introduction}
% ============================================================================

\subsection{Motivation}
% Why effect systems matter for PL implementation

\subsection{Contributions}
% What this survey provides

\subsection{Overview}
% Paper structure roadmap


% ============================================================================
\section{Background}
\label{sec:background}
% ============================================================================

\subsection{Monads and Computational Effects}
% Brief history: Moggi, Wadler

\subsection{The Expression Problem for Effects}
% Why composing effects is hard

\subsection{From Monad Transformers to Algebraic Effects}
% Evolution of approaches

\subsection{The Scheme Subset}
% Description of the language being interpreted
% Grammar specification


% ============================================================================
\section{Effect Systems Under Study}
\label{sec:systems}
% ============================================================================

\subsection{MTL: Monad Transformer Library}
\label{sec:mtl}

\subsubsection{Architecture}
% Type class based, transformer stacks

\subsubsection{Effect Stack for the Interpreter}
% ReaderT Env (StateT (Env, [String]) (WriterT [String] (Except Error))) a

\subsubsection{Lifting and Constraints}

\subsubsection{Advantages and Limitations}

% ----------------------------------------------------------------------------

\subsection{freer-simple}
\label{sec:freer-simple}

\subsubsection{Architecture}
% Freer monad, open unions, interpreters

\subsubsection{Effect Representation}

\subsubsection{Handler Composition}

\subsubsection{Advantages and Limitations}

% ----------------------------------------------------------------------------

\subsection{Polysemy}
\label{sec:polysemy}

\subsubsection{Architecture}
% Similar to freer, focus on optimization

\subsubsection{Effect Representation}

\subsubsection{Interpretation Strategies}

\subsubsection{GHC Plugin and Optimization}

\subsubsection{Advantages and Limitations}

% ----------------------------------------------------------------------------

\subsection{fused-effects}
\label{sec:fused-effects}

\subsubsection{Architecture}
% Algebraic effects with fusion

\subsubsection{Effect and Carrier Separation}

\subsubsection{Handler Fusion}

\subsubsection{Advantages and Limitations}

% ----------------------------------------------------------------------------

\subsection{effectful}
\label{sec:effectful}

\subsubsection{Architecture}
% IO-based, dynamic effects

\subsubsection{Static vs Dynamic Effects}

\subsubsection{Performance Pragmatism}

\subsubsection{Advantages and Limitations}


% ============================================================================
\section{Implementation: A Scheme Interpreter}
\label{sec:implementation}
% ============================================================================

\subsection{Abstract Syntax and Shared Infrastructure}
% Lexer, Parser, AST â€” shared across all implementations

\subsection{Semantic Domains}
% Values, Environments, Errors

\subsection{Effects Required}
% Reader (lexical env), State (mutable env + trace), Writer (logging), Error

\subsubsection{Reader: Lexical Environment}

\subsubsection{State: Mutable Bindings and Execution Trace}

\subsubsection{Writer: Logging}

\subsubsection{Error: Exception Handling}

\subsection{MTL Implementation}
\label{sec:impl-mtl}

\subsubsection{Type Definitions}

\subsubsection{Evaluation Function}

\subsubsection{Running the Stack}

\subsubsection{Code Observations}

% ----------------------------------------------------------------------------

\subsection{freer-simple Implementation}
\label{sec:impl-freer}

\subsubsection{Effect Definitions}

\subsubsection{Evaluation Function}

\subsubsection{Handlers and Interpretation Order}

\subsubsection{Code Observations}

% ----------------------------------------------------------------------------

\subsection{Polysemy Implementation}
\label{sec:impl-polysemy}

\subsubsection{Effect Definitions}

\subsubsection{Evaluation Function}

\subsubsection{Interpreters}

\subsubsection{Code Observations}

% ----------------------------------------------------------------------------

\subsection{fused-effects Implementation}
\label{sec:impl-fused}

\subsubsection{Effect and Carrier Definitions}

\subsubsection{Evaluation Function}

\subsubsection{Handler Composition}

\subsubsection{Code Observations}

% ----------------------------------------------------------------------------

\subsection{effectful Implementation}
\label{sec:impl-effectful}

\subsubsection{Effect Definitions}

\subsubsection{Evaluation Function}

\subsubsection{Dispatching Effects}

\subsubsection{Code Observations}


% ============================================================================
\section{Evaluation}
\label{sec:evaluation}
% ============================================================================

\subsection{Evaluation Criteria}

\subsubsection{Performance}
% Runtime, memory

\subsubsection{Expressiveness}
% What can/cannot be expressed, effect ordering flexibility

\subsubsection{Ergonomics}
% Boilerplate, type errors, learning curve

\subsubsection{Ecosystem Integration}
% Library support, documentation, maintenance

% ----------------------------------------------------------------------------

\subsection{Benchmark Methodology}
% Test programs, measurement approach, hardware

\subsection{Performance Results}
% Tables and figures

\subsubsection{Microbenchmarks}
% Individual effect operations

\subsubsection{Interpreter Benchmarks}
% Full evaluation of test programs

\subsubsection{Memory Usage}

\subsubsection{Compilation Time}

% ----------------------------------------------------------------------------

\subsection{Expressiveness Comparison}

\subsubsection{Effect Ordering and Reordering}

\subsubsection{Local vs Global Handlers}

\subsubsection{Higher-Order Effects}

\subsubsection{Effect Polymorphism}

% ----------------------------------------------------------------------------

\subsection{Ergonomics Comparison}

\subsubsection{Lines of Code}

\subsubsection{Type Signature Complexity}

\subsubsection{Error Message Quality}

\subsubsection{Refactoring Effort}


% ============================================================================
\section{Discussion}
\label{sec:discussion}
% ============================================================================

\subsection{When to Use Which System}
% Decision guide based on findings

\subsection{The Performance--Abstraction Trade-off}

\subsection{Type System Limitations}
% What Haskell's type system cannot express

\subsection{Comparison with Other Languages}
% OCaml effects, Koka, Eff, Frank

\subsection{Threats to Validity}


% ============================================================================
\section{Related Work}
\label{sec:related}
% ============================================================================

\subsection{Effect System Foundations}
% Plotkin \& Power, Plotkin \& Pretnar

\subsection{Monad Transformers}
% Liang, Hudak, Jones

\subsection{Algebraic Effects in Haskell}
% Kiselyov et al., Wu \& Schrijvers, Kammar et al.

\subsection{Effect System Comparisons}
% Prior surveys and benchmarks

\subsection{Interpreters as Effect System Benchmarks}


% ============================================================================
\section{Future Work}
\label{sec:future}
% ============================================================================

\subsection{Reflective Effect Systems}
% Connection to your PhD thesis

\subsection{Effect Handler Optimization}
% Fusion, partial evaluation

\subsection{Formal Verification of Effect Implementations}


% ============================================================================
\section{Conclusion}
\label{sec:conclusion}
% ============================================================================


% ============================================================================
% References
% ============================================================================

\bibliographystyle{ACM-Reference-Format}
\bibliography{references}


% ============================================================================
% Appendix
% ============================================================================

\appendix

\section{Complete Source Code}
\label{app:code}

\subsection{Shared Infrastructure}
% Lexer, Parser, AST

\subsection{MTL Implementation}

\subsection{freer-simple Implementation}

\subsection{Polysemy Implementation}

\subsection{fused-effects Implementation}

\subsection{effectful Implementation}


\section{Benchmark Programs}
\label{app:benchmarks}

\subsection{Factorial}

\subsection{Fibonacci}

\subsection{List Operations}

\subsection{Environment-Heavy Workloads}

\subsection{Error-Heavy Workloads}


\section{Raw Benchmark Data}
\label{app:data}


\end{document}